@using Microsoft.Extensions.Configuration
@*
    For more information on enabling MVC for empty projects, visit https://go.microsoft.com/fwlink/?LinkID=397860
*@
@model CashierDto;
@{
    Layout = null;
}
@inject IConfiguration Configuration

<!doctype html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Kumudu Hospital - Invoice</title>
    @* <link rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" /> *@

    <style>
        body {
            font-family: Arial, sans-serif;
        }

        .container {
            height: 297mm;
            width: 210mm;
            padding: 12px;
            padding-left: 32px;
        }

        .flex {
            display: flex;
        }

        .justify-between {
            justify-content: space-between;
        }

        img {
            max-width: 100%;
        }

        .text-4xl {
            font-size: 1.5rem;
        }

        .text-sm {
            font-size: 0.875rem;
        }

        .text-gray-400 {
            color: #718096;
        }

        .pt-16 {
            padding-top: 4rem;
        }

        .table-auto {
            width: 100%;
        }

        .border-b-2 {
            border-bottom-width: 2px;
        }

        .h-10 {
            height: 2.5rem;
        }

        .text-left {
            text-align: left;
        }

        .text-right {
            text-align: right;
        }

        .mt-5 {
            margin-top: 1.25rem;
        }

        .justify-end {
            justify-content: flex-end;
        }

        .pt-4 {
            padding-top: 1rem;
        }

        .text-xl {
            font-size: 1.25rem;
        }

        .font-bold {
            font-weight: bold;
        }

        .text-center {
            text-align: center;
        }

        .flex-row {
            flex-direction: row;
        }

        .font-normal {
            font-weight: normal;
        }
    </style>
</head>
<body>
    <div class="container h-[297mm] w-[210mm] p-12 pl-32">
        <div class="flex justify-between">
            <div style="display: flex; align-items: center">
                @* <img src=" ~ /assets/images/kumudu_logo2.jpg" /> *@
                <img src="https://kumuduhospital.com/assets/images/kumudu_logo2.jpg" />
                <div style="padding-left: 20px">
                    <p class="pb-2 text-4xl" style="margin: auto; font-weight: bold">
                        KUMUDU HOSPITAL
                    </p>
                    <p class="text-sm text-gray-400"
                       style="margin-top: 10px; margin-bottom: auto">
                        No 48, Kandy Road, Mathale,
                    </p>
                    <p class="text-sm text-gray-400"
                       style="margin-top: 10px; margin-bottom: auto">
                        Tel: 066 22 22 2444 | 066 22 30 027
                    </p>

                    @if (Model != null)
                    {
                        <input type="hidden" id="opid" asp-for="PreID" value="@Model.PreID">
                        @if (Model.cashierBillingItemDtoList != null)
                        {
                            @if (Model.invoiceType == HospitalMgrSystem.Model.Enums.InvoiceType.OPD)
                            {
                                <p class="pb-3 text-4xl" style="margin: auto; margin-top: 5px">OPD INVOICE</p>
                            }

                            @if (Model.invoiceType == HospitalMgrSystem.Model.Enums.InvoiceType.CHE)
                            {
                                <p class="pb-3 text-4xl" style="margin: auto; margin-top: 5px">Channeling INVOICE</p>
                            }

                            @if (Model.invoiceType == HospitalMgrSystem.Model.Enums.InvoiceType.ADM)
                            {
                                <p class="pb-3 text-4xl" style="margin: auto; margin-top: 5px">Admission INVOICE</p>
                            }
                        }

                        <p style="margin: auto; margin-top: 5px">@Model.invoice.ModifiedDate</p>
                    }
                </div>
            </div>
        </div>
        <div class="flex justify-between pt-16">
            @if (Model != null)
            {
                <div>
                    <p class="font-bold" style="margin: auto; margin-top: 10px">
                        PATIENT NAME: <span style="font-weight: normal;">@Model.customerName</span>
                    </p>
                    <p class="text-sm" style="margin: auto; margin-top: 10px">
                        PATIENT AGE: <span style="font-weight: normal;">@Model.patientAge</span>
                    </p>
                    <p class="text-sm" style="margin: auto; margin-top: 10px">
                        PATIENT SEX: <span style="font-weight: normal;">@Model.patientSex</span>
                    </p>
                    <p class="text-sm" style="margin: auto; margin-top: 10px">
                        PATIENT CONTACT NUMBER: <span style="font-weight: normal;">@Model.patientContactNo</span>
                    </p>
                    <p class="text-sm" style="margin: auto; margin-top: 10px">
                        DOCTOR NAME: <span style="font-weight: normal;">@Model.consaltantName</span>
                    </p>
                    <p class="text-sm font-bold" style="margin: auto; margin-top: 10px">
                        REF NO. <span class="pl-1 font-normal">@Model.PreID</span>
                    </p>
                </div>
            }
        </div>

        @if (Model != null)
        {
            <div class="pt-16">
                <table class="w-full table-auto text-sm">
                    <thead class="border-b-2">
                        <tr class="h-10 text-left">
                            <th>NO.</th>
                            <th>ITEM</th>
                            <th>PRICE RS.</th>
                            <th>QTY</th>
                            <th class="text-right" style="text-align: right;">TOTAL RS.</th>
                        </tr>
                    </thead>
                    <tbody>
                        @if (Model.invoiceType == HospitalMgrSystem.Model.Enums.InvoiceType.OPD)
                        {
                            var rowNumber = 1;
                            @foreach (var item in Model.OPDDrugusListInvoiced)
                            {
                                <tr class="h-10">
                                    <td>@rowNumber</td>
                                    <td>
                                        @item.Drug.DrugName
                                        @* <p style="margin: 0; padding: 0; font-size: 8px;">(@item.billingItemsTypeName)</p> *@
                                    </td>

                                    <td>@item.Price.ToString("0.#")</td>
                                    <td>@item.Qty.ToString("0.#")</td>
                                    <td class="text-right" style="text-align: right;">@item.Amount.ToString("0.#")</td>
                                </tr>
                                rowNumber++;
                            }
                        }
                    </tbody>
                </table>
            </div>

            <hr class="mt-5" />

            <div class="flex-row justify-end text-right pt-4">
                <div>Subtotal</div>
                <div class="text-xl">@Model.preSubtotal.ToString("0.00") LKR</div>
            </div>
            <div class="flex-row justify-end text-right pt-4">
                <div>Discount</div>
                <div class="text-xl">@Model.discount.ToString("0.00") LKR</div>
            </div>
            <div class="flex-row justify-end text-right pt-4">
                <div>Total Amount</div>
                <div class="text-xl">@Model.preTotal.ToString("0.00") LKR</div>
            </div>
            <div class="flex-row justify-end text-right pt-4">
                <div>Cash Payment</div>
                <div class="text-xl">@Model.totalPaymentPaidAmount.ToString("0.00") LKR</div>
            </div>
            <div class="flex-row justify-end text-right pt-4">
                <div>Balance</div>
                <div class="text-xl font-bold">@Model.total.ToString("0.00") LKR</div>
            </div>
        }

        <p class="text-center font-bold text-xl">Thank you for your cooperation!</p>
    </div>

    <script src="https://cdn.rawgit.com/davidshimjs/qrcodejs/gh-pages/qrcode.min.js"></script>
    <script type="text/javascript">
        // Call the generateQRCode function when the page loads
        document.addEventListener("DOMContentLoaded", function () {
            generateQRCode(50);
        });

        function generateQRCode(size) {
            var preID = document.getElementById("preID").value;
            console.log("pre ID is" + preID);
            var data = preID;
            const qrcode = new QRCode(document.getElementById("qrcode"), {
                text: data,
                width: size,
                height: size,
            });
        }

        // Rest of your script...
    </script>
</body>
</html>